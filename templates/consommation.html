{% extends 'base.html' %}

{% block title %}Consommation{% endblock %}

{% block content %}
<main>
    <h1 class="centered-title">Consommation et Prix du Logement 1</h1>

    <!-- Conteneur des graphiques -->
    <div id="consommation_chart" style="width: 100%; height: 500px;"></div>

    <!-- Tableau des consommations -->
    <div class="table-container">
        <h2>Consommation Annuelle</h2>
        <table>
            <thead>
                <tr>
                    <th>Type</th>
                    <th>Valeur Consommée</th>
                    <th>Unité</th>
                    <th>Prix Total (€)</th>
                </tr>
            </thead>
            <tbody>
                {% for type, valeur, unite, prix in consommations %}
                <tr>
                    <td>{{ type }}</td>
                    <td>{{ valeur }}</td>
                    <td>{{ unite }}</td>
                    <td>{{ prix }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</main>

<!-- Script Google Charts -->
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
        // Préparation des données pour le graphique
        var data = google.visualization.arrayToDataTable([
            ['Type de Consommation', 'Valeur Consommée', 'Prix Total (€)'],
            {% for type, valeur, unite, prix in consommations %}
                ['{{ type }} ({{ unite }})', {{ valeur }}, {{ prix }}],
            {% endfor %}
        ]);

        // Options du graphique
        var options = {
            title: 'Consommation et Prix par Type sur 2024',
            hAxis: { title: 'Type de Consommation', titleTextStyle: { color: '#333' } },
            vAxis: { title: 'Valeurs et Prix', minValue: 0 },
            chartArea: { width: '70%', height: '70%' },
            series: {
                0: { color: '#4285F4' }, // Couleur pour les consommations
                1: { color: '#DB4437' }  // Couleur pour les prix
            }
        };

        // Dessin du graphique
        var chart = new google.visualization.ColumnChart(document.getElementById('consommation_chart'));
        chart.draw(data, options);
    }
</script>
{% endblock %}
